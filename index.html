<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Love Animation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      background: #000;
      overflow: hidden;
      font-family: "Poppins", system-ui, sans-serif;
    }

    /* N·ªÅn hi·ªáu ·ª©ng m∆∞a ch·ªØ */
    canvas {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 1;
      display: block;
    }

    /* TEXT ·ªû GI·ªÆA (5,4,3,2,1 + c√°c c√¢u ch√∫c) */
    .center-text {
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      font-family: "Courier New", monospace;
      font-size: 80px;
      font-weight: 900;
      text-align: center;
      letter-spacing: 6px;
      white-space: nowrap;
      text-transform: uppercase;

      background-image:
        radial-gradient(circle at 1px 1px, #ffecfb 1px, transparent 0),
        radial-gradient(circle at 1px 1px, #ffb4e9 1px, transparent 0);
      background-size: 5px 5px, 8px 8px;
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;

      text-shadow:
        0 0 2px #ffffff,
        0 0 6px #ff8ccc,
        0 0 15px #ff4b9a,
        0 0 30px #ff007f;

      opacity: 0;
      transition: opacity .5s ease, transform .5s ease;
      z-index: 3;
    }

    .center-text.show {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }

    /* TR√ÅI TIM TO ·ªû CU·ªêI */
    .heart-container {
      position: fixed;
      top: 48%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1.3);
      opacity: 0;
      transition: opacity 1s ease, transform 1s ease;
      z-index: 3;
      pointer-events: none;
      text-align: center;
    }

    .heart-container.show {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.7);
    }

    .heart-outline {
      width: 540px;
      height: 480px;
      margin: auto;
      position: relative;
    }

    .heart-outline svg {
      width: 100%;
      height: 100%;
      display: block;
    }

    .heart-outline svg path {
      stroke: #ffc6f1;
      stroke-width: 4;
      fill: none;
      filter: drop-shadow(0 0 10px rgba(255, 150, 230, 1));
      animation: heartGlow 1.6s ease-in-out infinite alternate;
    }

    @keyframes heartGlow {
      from {
        stroke: #ff9cde;
        filter: drop-shadow(0 0 6px #ff9adb);
      }
      to {
        stroke: #ffffff;
        filter:
          drop-shadow(0 0 14px #ffe6ff)
          drop-shadow(0 0 26px #ff5fb4);
      }
    }

    .heart-name {
      position: absolute;
      top: 47%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 26px;
      font-weight: 700;
      color: #ffe8f7;
      text-shadow:
        0 0 3px #fff,
        0 0 12px #ff7fcf,
        0 0 22px #ff3e9f;
      white-space: nowrap;
      animation: namePulse 1.5s ease-in-out infinite alternate;
    }

    @keyframes namePulse {
      from { transform: translate(-50%, -50%) scale(0.95); }
      to   { transform: translate(-50%, -50%) scale(1.05); }
    }

    .floating-text {
      position: fixed;
      color: #ffd6f4;
      font-size: 18px;
      font-weight: 600;
      text-shadow:
        0 0 2px #ffffff,
        0 0 10px rgba(255, 170, 230, 0.9);
      z-index: 2;
      white-space: nowrap;
      pointer-events: none;
      animation: floatDown 12s linear forwards;
    }

    @keyframes floatDown {
      0% {
        transform: translateY(-40px) translateX(0) rotate(0deg);
        opacity: 0;
      }
      15% {
        opacity: 1;
      }
      50% {
        transform: translateY(40px) translateX(15px) rotate(4deg);
      }
      100% {
        transform: translateY(80px) translateX(-10px) rotate(-4deg);
        opacity: 0;
      }
    }

    /* ·∫¢NH ·ªû CU·ªêI ‚Äì ph√≥ng to gi·ªØa m√†n h√¨nh, che tim */
    .final-img {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.3);
      width: 60vw;
      max-width: 450px;
      border-radius: 20px;
      box-shadow:
        0 0 14px rgba(255, 180, 230, 0.95),
        0 0 30px rgba(255, 90, 180, 0.8);
      opacity: 0;
      transition: opacity 1.6s ease, transform 1.6s ease;
      z-index: 5;
    }

    .final-img.show {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.25);
    }

    /* OVERLAY NH·∫§N ƒê·ªÇ B·∫ÆT ƒê·∫¶U */
    .start-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #ff99cc44, #000000ee);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: #ffe6ff;
      text-align: center;
      padding: 24px;
    }

    .start-title {
      font-size: 26px;
      margin-bottom: 12px;
    }

    .start-sub {
      font-size: 16px;
      opacity: 0.85;
      margin-bottom: 24px;
    }

    .start-btn {
      padding: 12px 28px;
      border-radius: 999px;
      border: 1px solid #ffb3e6;
      background: linear-gradient(45deg, #ff5fb4, #ff9adf);
      color: #fff;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      box-shadow:
        0 0 10px rgba(255, 140, 210, 0.8),
        0 0 20px rgba(255, 100, 200, 0.7);
      transition: transform 0.2s ease, box-shadow 0.2s ease, opacity 0.3s ease;
    }

    .start-btn:hover {
      transform: scale(1.05);
      box-shadow:
        0 0 14px rgba(255, 140, 210, 0.9),
        0 0 26px rgba(255, 100, 200, 0.85);
    }

    .start-overlay.hide {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
    }
  </style>
</head>
<body>

<!-- NH·∫†C N·ªÄN -->
<audio id="bgm" src="music.mp3" preload="auto" loop></audio>

<!-- OVERLAY NH·∫§N ƒê·ªÇ B·∫ÆT ƒê·∫¶U -->
<div id="startOverlay" class="start-overlay">
  <div class="start-title">Nh·∫•n ƒë·ªÉ b·∫Øt ƒë·∫ßu m√≥n qu√† c·ªßa b√© ‚ú®</div>
  <div class="start-sub">B·∫≠t nh·∫°c + xem ƒëi·ªÅu b·∫•t ng·ªù d√†nh cho anhiu n√® üíó</div>
  <button class="start-btn" id="startButton">B·∫Øt ƒë·∫ßu</button>
</div>

<canvas id="matrix"></canvas>

<div id="centerText" class="center-text"></div>

<div id="heartContainer" class="heart-container">
  <div class="heart-outline">
    <svg viewBox="0 0 200 180">
      <path d="M100 165
               L40 105
               C10 75 10 35 40 20
               C65 7 90 20 100 35
               C110 20 135 7 160 20
               C190 35 190 75 160 105
               Z"/>
    </svg>
    <div class="heart-name">
      ‚ô• NGUY·ªÑN HO√ÄNG HI·ªÜP ‚ô•
    </div>
  </div>
</div>

<img id="finalImage" src="final.png" alt="us" class="final-img" />

<script>
  /* ========== N·ªÄN M∆ØA CH·ªÆ ========== */
  const canvas = document.getElementById("matrix");
  const ctx = canvas.getContext("2d");
  const letters = "I LOVE YOU NPT ".split("");
  let fontSize = 20;
  let columns, drops;

  function resizeMatrix() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    fontSize = Math.floor(window.innerWidth / 55);
    columns = Math.floor(window.innerWidth / fontSize);

    drops = Array.from({ length: columns }, () =>
      Math.floor(Math.random() * (canvas.height / fontSize))
    );
  }

  window.addEventListener("resize", resizeMatrix);
  resizeMatrix();

  function drawMatrix() {
    ctx.fillStyle = "rgba(0, 0, 0, 0.03)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.font = fontSize + "px monospace";

    for (let i = 0; i < drops.length; i++) {
      const txt = letters[(Math.random() * letters.length) | 0];
      const x = i * fontSize;
      const y = drops[i] * fontSize;

      const intensity = y / canvas.height;
      const r = 255;
      const g = 90 + intensity * 100;
      const b = 160 + intensity * 80;
      ctx.fillStyle = `rgb(${r}, ${g}, ${b})`;

      ctx.fillText(txt, x, y);

      if (y > canvas.height && Math.random() > 0.95) {
        drops[i] = 0;
      }
      drops[i]++;
    }
    requestAnimationFrame(drawMatrix);
  }
  drawMatrix();

  /* ========== SEQUENCE CH·ªÆ CH√çNH + TR√ÅI TIM + ·∫¢NH + CH·ªÆ BAY ========== */
  const centerText = document.getElementById("centerText");
  const heartContainer = document.getElementById("heartContainer");
  const finalImage = document.getElementById("finalImage");

  const LINES = [
    "5",
    "4",
    "3",
    "2",
    "1",
    "Happy boy's day 19/11",
    "Ch√∫c anhiu c·ªßa b√©",
    "lu√¥n vui v·∫ª",
    "h·∫°nh ph√∫c",
    "b√¨nh an",
    "v√† y√™u b√© nhi·ªÅu h∆°n nh·ªõ",
    "C·∫£m ∆°n anh v√¨ ƒë√£ xu·∫•t hi·ªán<br>v√† th∆∞∆°ng y√™u em",
    "Iu anhhh aaaaaa"
  ];

  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  function spawnFloatingMessages() {
    const messages = [
      "Happy boy's day 19/11",
      "lu√¥n vui v·∫ª, h·∫°nh ph√∫c, b√¨nh an",
      "y√™u b√© nhi·ªÅu h∆°n n·ªØa nha",
      "C·∫£m ∆°n anh v√¨ ƒë√£ th∆∞∆°ng em"
    ];

    const vw = window.innerWidth;
    const vh = window.innerHeight;

    for (let i = 0; i < 12; i++) {
      const span = document.createElement("span");
      span.className = "floating-text";
      span.textContent = messages[i % messages.length];

      const x = Math.random() * (vw - 260);
      const y = Math.random() * (vh * 0.5);

      span.style.left = x + "px";
      span.style.top = y + "px";

      document.body.appendChild(span);
      setTimeout(() => span.remove(), 12000);
    }
  }

  async function startSequence() {
    const showTime = 2000;
    const gapTime  = 400;

    for (const text of LINES) {
      centerText.innerHTML = text;
      centerText.classList.add("show");

      const extra = (text === "Ch√∫c anhiu c·ªßa b√©") ? 1000 : 0;
      await sleep(showTime + extra);

      centerText.classList.remove("show");
      await sleep(gapTime);
    }

    heartContainer.classList.add("show");
    await sleep(2500);

    finalImage.classList.add("show");
    heartContainer.style.opacity = 0.25;
    await sleep(1500);

    spawnFloatingMessages();
    setTimeout(spawnFloatingMessages, 6000);
  }

  // X·ª¨ L√ù N√öT "B·∫ÆT ƒê·∫¶U"
  window.addEventListener("load", () => {
    const bgm = document.getElementById("bgm");
    const overlay = document.getElementById("startOverlay");
    const btn = document.getElementById("startButton");

    const startAll = () => {
      // b·∫≠t nh·∫°c
      if (bgm) {
        bgm.volume = 0.8;
        bgm.play().catch(() => {
          console.warn("Kh√¥ng b·∫≠t ƒë∆∞·ª£c nh·∫°c (policy tr√¨nh duy·ªát).");
        });
      }
      // ·∫©n overlay
      overlay.classList.add("hide");
      // b·∫Øt ƒë·∫ßu animation
      setTimeout(startSequence, 400);
    };

    btn.addEventListener("click", startAll, { once: true });
    overlay.addEventListener("click", (e) => {
      if (e.target === overlay) startAll();
    }, { once: true });
  });
</script>

</body>
</html>

